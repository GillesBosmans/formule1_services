services:
 mysql-driver:
  image: mysql:latest
  ports:
    - 3307:3306
  volumes:
    - mysql_driver_data:/var/lib/mysql
  environment:
   MYSQL_ROOT_PASSWORD: abc123

 mysql-team:
  image: mysql:latest
  ports:
    - 3308:3306
  volumes:
    - mysql_team_data:/var/lib/mysql
  environment:
   MYSQL_ROOT_PASSWORD: abc123
   
 mysql-track:
  image: mysql:latest
  ports:
    - 3309:3306
  volumes:
    - mysql_track_data:/var/lib/mysql
  environment:
   MYSQL_ROOT_PASSWORD: abc123
   
 mongo-results:
  image: mongo:latest
  ports: 
    - 27017:27017
  volumes:
    - mongodb_results_data:/data/db

 driver-service:
  depends_on:
    - mysql-driver
  image: bricesey/driver-service
  ports: 
    - 8081:8081
  volumes:
    - mysql_driver_data:/var/lib/mysql
  environment:
    - MYSQL_DB_HOST: mysql-driver
    - MYSQL_DB_PORT: 3307
    - MYSQL_DB_USERNAME: root
    - MYSQL_DB_PASSWORD: abc123

 team-service:
  depends_on:
    - mysql-team
  image: bricesey/team-service
  ports: 
    - 8082:8082
  volumes:
    - mysql_team_data:/var/lib/mysql
  environment:
    - MYSQL_DB_HOST: mysql-team
    - MYSQL_DB_PORT: 3308
    - MYSQL_DB_USERNAME: root
    - MYSQL_DB_PASSWORD: abc123

 track-service:
  depends_on:
    - mysql-track
  image: bricesey/track-service
  ports: 
    - 8083:8083
  volumes:
    - mysql_track_data:/var/lib/mysql
  environment:
    - MYSQL_DB_HOST: mysql-track
    - MYSQL_DB_PORT: 3309
    - MYSQL_DB_USERNAME: root
    - MYSQL_DB_PASSWORD: abc123

 results-service:
  depends_on:
    - mongo-results
  image: bricesey/results-service
  ports: 
    - 8084:8084
  volumes:
    - mongodb_results_data:/data/db
  environment:
    - MONGODB-PORT: 27017
    - MONGODB-HOST: mongo-results

volumes:
 mongodb_results_data:
 mysql_driver_data:
 mysql_team_data:
 mysql_track_data: